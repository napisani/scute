# scute - AI Shell Assistant

`scute` is a command-line tool that acts as an AI-powered shell assistant. It integrates with your shell to provide command suggestions, completions, and explanations on the fly, triggered by keyboard shortcuts.

## Features

- **Command Suggestion (`Ctrl+G`)**: Completes your currently typed command using an AI.
- **Prompt-based Suggestion (`Ctrl+P`)**: Generates a command based on a descriptive prompt.
- **Command Explanation (`Ctrl+E`)**: Displays a non-intrusive explanation of the command under your cursor.

## Installation

### 1. Build the Executable

First, build the standalone executable from source. A `build` script is provided in `package.json`.

```sh
bun run build
```

This will create a single binary file named `scute` in the root of the project directory.

### 2. Configure your OpenAI key

`scute` currently uses OpenAI through the TanStack AI SDK. Set `OPENAI_API_KEY` before running the binary:

```sh
export OPENAI_API_KEY="sk-..."
```

Add this to your shell profile (e.g. `.bashrc`, `home.nix`, etc.) so it is always available.

### 3. Install the Executable

Next, make the binary executable and move it to a directory in your system's `PATH`.

```sh
# Make it executable
chmod +x scute

# Move it to a standard location
# Note: This may require sudo privileges.
sudo mv scute /usr/local/bin/
```
**Alternative:** If you don't have `sudo` access or prefer a user-level installation, you can place it in `~/.local/bin` (ensure this directory is in your `$PATH`).

```sh
# Ensure the directory exists
mkdir -p ~/.local/bin

# Move the binary
mv scute ~/.local/bin/
```

## Shell Integration

`scute` integrates with your shell via a script that needs to be loaded by your shell's configuration file (e.g., `.bashrc`).

### For Bash

Add the following line to the end of your `~/.bashrc` file:

```sh
eval "$(scute init bash)"
```

After adding the line, restart your terminal or run `source ~/.bashrc` to apply the changes.

### For Nix/home-manager Users

If you use `home-manager` to manage your dotfiles, you cannot edit `.bashrc` directly. Instead, add the following to your `home.nix` configuration:

```nix
programs.bash = {
  enable = true;
  bashrcExtra = ''
    eval "$(scute init bash)"
  '';
};
```

Then, run `home-manager switch` to apply the configuration.

## Debug Logging

Set `SCUTE_DEBUG=1` to enable verbose logs. When enabled, `scute` writes detailed traces to `/tmp/scute.log`:

```sh
export SCUTE_DEBUG=1
tail -f /tmp/scute.log
```

### Inspect Resolved Configuration

Use the `config-debug` subcommand to print the fully resolved configuration (including environment overrides). This is useful when troubleshooting provider settings or custom config files:

```sh
scute --config configs/ollama-config.yml config-debug
```

The command prints a JSON payload containing the merged configuration and relevant environment variables.

## Testing

Test files use the `.test.ts` suffix. Evaluation tests use `.eval.test.ts` and live in the `evals/` directory.

```sh
# Run standard unit tests
bun run test

# Run evaluation tests
bun run test:evals
```

## Usage

Once installed and configured, you can use the following keyboard shortcuts in your terminal:

- **`Ctrl + G`**: **Suggest Completion**. Takes the current command you are typing, sends it to the AI for completion, and replaces the line with the AI's suggestion.
- **`Ctrl + P`**: **Suggest from Prompt**. Replaces your current line with a command generated by the AI based on a prompt. (Note: The current implementation is a stub).
- **`Ctrl + E`**: **Explain Command**. Reads the command on the current line and displays a helpful, non-interfering explanation on the line below your prompt.
