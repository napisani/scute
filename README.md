# scute - AI Shell Assistant

`scute` is a command-line tool that acts as an AI-powered shell assistant. It integrates with your shell to provide command suggestions, completions, and explanations on the fly, triggered by keyboard shortcuts.

## Features

- **Command Suggestion (`Ctrl+G`)**: Completes your currently typed command using an AI.
- **Prompt-based Suggestion (`Ctrl+P`)**: Generates a command based on a descriptive prompt.
- **Command Explanation (`Ctrl+E`)**: Displays a non-intrusive explanation of the command under your cursor.

## Installation

Pick the option that fits your workflow best.

### Binary releases (macOS, Linux, Windows)

Every Git tag publishes prebuilt binaries on the [GitHub Releases](https://github.com/napisani/scute/releases) page. Download the archive for your platform, make it executable, and move it onto your `PATH`:

```sh
curl -L -o scute "https://github.com/napisani/scute/releases/download/vX.Y.Z/scute-macos"
chmod +x scute
sudo mv scute /usr/local/bin/
```

Windows users can grab `scute-windows.exe` and place it anywhere on their `%PATH%` (e.g. `C:\Users\you\AppData\Local\Microsoft\WindowsApps`).

### Homebrew (macOS / Linux)

```sh
brew tap napisani/scute https://github.com/napisani/scute
brew install scute
```

### npm / npx

Install globally:

```sh
npm install -g @napisani/scute
```

Or run once with:

```sh
npx @napisani/scute --help
```

> The npm package ships the native binary produced by the Bun compiler, so Bun is **not** required at runtime.

### Nix flakes

Add the repo as an input and use it in your Home Manager flake:

```nix
inputs.scute.url = "github:napisani/scute";

outputs = { self, nixpkgs, scute, ... }: {
  homeConfigurations.me = nixpkgs.lib.homeManagerConfiguration {
    # ...
    packages = [ scute.packages.${pkgs.system}.default ];
  };
};
```

> The repository ships an intentionally minimal `flake.nix`. Run `nix flake lock --update-input scute` inside your own workspace to pin exact revisions.

### Build from source

```sh
git clone https://github.com/napisani/scute.git
cd scute
bun install --frozen-lockfile
bun run build:bin
sudo mv dist/scute /usr/local/bin/
```

If you prefer Make targets:

```sh
make build
sudo mv dist/scute /usr/local/bin/
```

### Configure your provider keys

`scute` uses TanStack AI adapters. Set credentials before running:

```sh
export OPENAI_API_KEY="sk-..."
```

Add the variables to your shell profile or Home Manager configuration so they persist.

## Shell Integration

`scute` integrates with your shell via a script that needs to be loaded by your shell's configuration file (e.g., `.bashrc`).

### For Bash

Add the following line to the end of your `~/.bashrc` file:

```sh
eval "$(scute init bash)"
```

After adding the line, restart your terminal or run `source ~/.bashrc` to apply the changes.

### For Nix/home-manager Users

If you use `home-manager` to manage your dotfiles, you cannot edit `.bashrc` directly. Instead, add the following to your `home.nix` configuration:

```nix
programs.bash = {
  enable = true;
  bashrcExtra = ''
    eval "$(scute init bash)"
  '';
};
```

Then, run `home-manager switch` to apply the configuration.

## Debug Logging

Set `SCUTE_DEBUG=1` to enable verbose logs. When enabled, `scute` writes detailed traces to `/tmp/scute.log`:

```sh
export SCUTE_DEBUG=1
tail -f /tmp/scute.log
```

### Inspect Resolved Configuration

Use the `config-debug` subcommand to print the fully resolved configuration (including environment overrides). This is useful when troubleshooting provider settings or custom config files:

```sh
scute --config configs/ollama-config.yml config-debug
```

The command prints a JSON payload containing the merged configuration and relevant environment variables.

## Testing

Test files use the `.test.ts` suffix. Evaluation tests use `.eval.test.ts` and live in the `evals/` directory.

```sh
# Run standard unit tests
bun run test

# Run evaluation tests
bun run evals

# Or via Make targets
make test
```

## Usage

Once installed and configured, you can use the following keyboard shortcuts in your terminal:

- **`Ctrl + G`**: **Suggest Completion**. Takes the current command you are typing, sends it to the AI for completion, and replaces the line with the AI's suggestion.
- **`Ctrl + P`**: **Suggest from Prompt**. Replaces your current line with a command generated by the AI based on a prompt. (Note: The current implementation is a stub).
- **`Ctrl + E`**: **Explain Command**. Reads the command on the current line and displays a helpful, non-interfering explanation on the line below your prompt.

## Continuous Integration & Releases

- Pull requests run linting, tests, and a binary build on macOS, Linux, and Windows via [GitHub Actions](.github/workflows/ci.yml).
- Pushing a tag that matches `v*` automatically builds platform binaries, uploads them to a GitHub release, and publishes the npm package. See [release.yml](.github/workflows/release.yml) for the full pipeline.
- Homebrew users can install from the tap defined in [`Formula/scute.rb`](Formula/scute.rb).
- Nix users can consume the project as a flake (`flake.nix`).
